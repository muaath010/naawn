<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¹Ø§ÙˆÙ† | Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold-primary: #D4AF37;
            --red-dark: #4a0404;
            --black-bg: #120000;
            --glass: rgba(50, 0, 0, 0.8);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Tajawal', sans-serif; }
        body {
            background: radial-gradient(circle at center, var(--red-dark), var(--black-bg));
            min-height: 100vh; color: #fff; overflow-x: hidden;
        }
        .container { max-width: 500px; margin: 0 auto; padding: 20px; }
        header { text-align: center; padding: 30px 0; }
        .logo-area img { width: 100px; height: 100px; border-radius: 50%; border: 2px solid var(--gold-primary); }
        h1 { color: var(--gold-primary); font-size: 1.8rem; margin-top: 10px; }
        .card { background: var(--glass); border: 1px solid var(--gold-primary); border-radius: 15px; padding: 25px; margin-bottom: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .form-group { margin-bottom: 15px; text-align: right; }
        label { display: block; color: var(--gold-primary); margin-bottom: 5px; font-weight: bold; }
        input, textarea { width: 100%; padding: 12px; background: rgba(0,0,0,0.5); border: 1px solid #555; border-radius: 8px; color: #fff; outline: none; }
        input:focus { border-color: var(--gold-primary); }
        .btn { width: 100%; padding: 15px; border: none; border-radius: 10px; font-size: 1.1rem; font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 10px; }
        .btn-gold { background: linear-gradient(45deg, #aa8c2c, #d4af37); color: #120000; }
        .btn-red { background: transparent; color: #fff; border: 1px solid var(--gold-primary); }
        .screen { display: none; animation: fadeIn 0.5s ease; }
        .active-screen { display: block; }
        .loader { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 1000; justify-content: center; align-items: center; flex-direction: column; }
        .spinner { width: 40px; height: 40px; border: 4px solid rgba(212,175,55,0.1); border-top: 4px solid var(--gold-primary); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div class="loader" id="loader">
        <div class="spinner"></div>
        <p style="margin-top:15px; color:var(--gold-primary)">Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø·Ù„Ø¨...</p>
    </div>

    <div class="container">
        <header>
            <div class="logo-area"><img src="https://i.postimg.cc/htw4PMrc/nskht-mn-Beige-Orange-Simple-Illustration-Pickup-and-Delivery-Service-instagram-Post.jpg"></div>
            <h1>ÙØ±ÙŠÙ‚ Ù†Ø¹Ø§ÙˆÙ†</h1>
        </header>

        <div id="mainScreen" class="screen active-screen">
            <div class="card">
                <button onclick="showScreen('addOrderScreen')" class="btn btn-gold">â• Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</button>
                <button onclick="showScreen('loginScreen')" class="btn btn-red">ğŸ”’ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</button>
            </div>
        </div>

        <div id="addOrderScreen" class="screen">
            <div class="card">
                <form id="orderForm" onsubmit="submitOrder(event)">
                    <div class="form-group"><label>Ø§Ù„Ù…Ø·Ø¹Ù…</label><input type="text" name="restaurant" required></div>
                    <div class="form-group"><label>Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</label><input type="text" name="driver" required></div>
                    <div class="form-group"><label>Ø±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©</label><input type="text" name="card"></div>
                    <div class="form-group"><label>Ø§Ù„Ù…ÙƒØ§Ù†</label><input type="text" name="location" required></div>
                    <div class="form-group"><label>Ø§Ù„ØªØ§Ø±ÙŠØ®</label><input type="date" name="date" id="dateInput" required></div>
                    <div class="form-group"><label>Ø§Ù„Ø¹Ø¯Ø¯</label><input type="number" name="count" required></div>
                    <div class="form-group"><label>Ø§Ù„Ù…Ø¨Ù„Øº (Ø±.Ø¹)</label><input type="text" name="amount" required></div>
                    <div class="form-group"><label>ØªÙØ§ØµÙŠÙ„</label><textarea name="details"></textarea></div>
                    <button type="submit" class="btn btn-gold">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                    <button type="button" onclick="showScreen('mainScreen')" class="btn btn-red">Ø±Ø¬ÙˆØ¹</button>
                </form>
            </div>
        </div>

        <div id="loginScreen" class="screen">
            <div class="card">
                <form onsubmit="handleLogin(event)">
                    <div class="form-group"><label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label><input type="text" name="username" required></div>
                    <div class="form-group"><label>Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ</label><input type="password" name="password" required></div>
                    <button type="submit" class="btn btn-gold">Ø¯Ø®ÙˆÙ„</button>
                    <button type="button" onclick="showScreen('mainScreen')" class="btn btn-red">Ø±Ø¬ÙˆØ¹</button>
                </form>
            </div>
        </div>

        <div id="summaryScreen" class="screen">
            <div class="card">
                <h2 id="summaryTitle" style="color:var(--gold-primary); margin-bottom:15px;"></h2>
                <p>ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­. Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªØ§Ø­Ø© Ø§Ù„Ø¢Ù† ÙÙŠ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ.</p>
                <button onclick="location.reload()" class="btn btn-red">Ø®Ø±ÙˆØ¬</button>
            </div>
        </div>
    </div>

    <script>
        // Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø§Ù„Ø°ÙŠ Ø²ÙˆØ¯ØªÙ†ÙŠ Ø¨Ù‡
        const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyHvOhmNJoJHT6YOh6euQCnGAfmZWojrfgs8P87aKe4G2MlVGGO7izoQVb3K7zcqPRN/exec";

        document.getElementById('dateInput').valueAsDate = new Date();

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active-screen'));
            document.getElementById(id).classList.add('active-screen');
        }

        function toggleLoader(show) {
            document.getElementById('loader').style.display = show ? 'flex' : 'none';
        }

        // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… GET Ù„ØªÙØ§Ø¯ÙŠ Ù…Ø´Ø§ÙƒÙ„ CORS
        async function submitOrder(e) {
            e.preventDefault();
            toggleLoader(true);
            const formData = new FormData(e.target);
            const params = new URLSearchParams(Object.fromEntries(formData.entries()));
            params.append("action", "addOrder");

            fetch(`${APPS_SCRIPT_URL}?${params.toString()}`)
                .then(res => res.json())
                .then(data => {
                    toggleLoader(false);
                    alert("âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­");
                    e.target.reset();
                    showScreen('mainScreen');
                })
                .catch(err => {
                    toggleLoader(false);
                    alert("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (ØªØ­Ù‚Ù‚ Ù…Ù† Ø¬ÙˆØ¬Ù„ Ø´ÙŠØª)");
                });
        }

        async function handleLogin(e) {
            e.preventDefault();
            toggleLoader(true);
            const user = e.target.username.value;
            const pass = e.target.password.value;

            fetch(`${APPS_SCRIPT_URL}?action=login&username=${encodeURIComponent(user)}&password=${encodeURIComponent(pass)}`)
                .then(res => res.json())
                .then(data => {
                    toggleLoader(false);
                    if(data.status === "success") {
                        document.getElementById('summaryTitle').innerText = "Ù…Ø±Ø­Ø¨Ø§Ù‹: " + user;
                        showScreen('summaryScreen');
                    } else {
                        alert("âŒ Ø®Ø·Ø£: Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­");
                    }
                })
                .catch(() => {
                    toggleLoader(false);
                    alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±");
                });
        }
    </script>
</body>
</html>
