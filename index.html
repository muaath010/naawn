<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ù†Ø¹Ø§ÙˆÙ† Ø§Ù„Ù…ÙˆØ­Ø¯</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #D4AF37; --dark-red: #4a0404; --bg: #120000; }
        * { box-sizing: border-box; font-family: 'Tajawal', sans-serif; }
        body { background: radial-gradient(circle, var(--dark-red), var(--bg)); color: #fff; min-height: 100vh; margin: 0; padding: 20px; text-align: center; }
        .card { background: rgba(0,0,0,0.8); border: 1px solid var(--gold); border-radius: 15px; padding: 25px; max-width: 450px; margin: 20px auto; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .logo { width: 110px; height: 110px; border-radius: 50%; border: 2px solid var(--gold); margin-bottom: 15px; }
        input, textarea { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #555; background: #000; color: #fff; text-align: center; font-size: 1rem; }
        .btn { width: 100%; padding: 15px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 10px; font-size: 1.1rem; }
        .btn-gold { background: var(--gold); color: #000; }
        .btn-gold:hover { background: #b8952e; }
        .btn-outline { background: transparent; color: #fff; border: 1px solid var(--gold); }
        .screen { display: none; animation: fadeIn 0.4s ease; }
        .active { display: block; }
        #loader { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 100; flex-direction: column; justify-content: center; align-items: center; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div id="loader"><p style="color:var(--gold)">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...</p></div>

    <img src="https://i.postimg.cc/htw4PMrc/nskht-mn-Beige-Orange-Simple-Illustration-Pickup-and-Delivery-Service-instagram-Post.jpg" class="logo">
    <h2 style="color:var(--gold)">ÙØ±ÙŠÙ‚ Ù†Ø¹Ø§ÙˆÙ†</h2>

    <div id="mainScreen" class="screen active">
        <div class="card">
            <button onclick="showScreen('orderScreen')" class="btn btn-gold">â• ØªØ³Ø¬ÙŠÙ„ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</button>
            <button onclick="showScreen('loginScreen')" class="btn btn-outline">ğŸ”’ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…</button>
        </div>
    </div>

    <div id="orderScreen" class="screen">
        <div class="card">
            <h3>ØªØ³Ø¬ÙŠÙ„ Ø·Ù„Ø¨ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©</h3>
            <form id="orderForm">
                <input type="text" name="restaurant" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø·Ø¹Ù…" required>
                <input type="text" name="driver" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨" required>
                <input type="text" name="card" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©">
                <input type="text" name="location" placeholder="Ù…ÙƒØ§Ù† Ø§Ù„ØªÙˆØµÙŠÙ„" required>
                <input type="date" name="date" id="dateField" required>
                <input type="number" name="count" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª" required>
                <input type="text" name="amount" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº (Ù…Ø«Ø§Ù„: 0.800)" required>
                <textarea name="details" placeholder="ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ©"></textarea>
                <button type="submit" class="btn btn-gold">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</button>
                <button type="button" onclick="showScreen('mainScreen')" class="btn btn-outline">Ø±Ø¬ÙˆØ¹</button>
            </form>
        </div>
    </div>

    <div id="loginScreen" class="screen">
        <div class="card">
            <h3>Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ÙŠÙ† ÙˆØ§Ù„Ù…Ø·Ø§Ø¹Ù…</h3>
            <form id="loginForm">
                <input type="text" name="username" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" required>
                <input type="password" name="password" placeholder="Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ" required>
                <button type="submit" class="btn btn-gold">Ø¯Ø®ÙˆÙ„</button>
                <button type="button" onclick="showScreen('mainScreen')" class="btn btn-outline">Ø±Ø¬ÙˆØ¹</button>
            </form>
        </div>
    </div>

    <div id="summaryScreen" class="screen">
        <div class="card">
            <h3 id="welcomeMsg" style="color:var(--gold)"></h3>
            <p>ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„Ùƒ Ø¨Ù†Ø¬Ø§Ø­ Ø¥Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù….</p>
            <button onclick="location.reload()" class="btn btn-outline">Ø®Ø±ÙˆØ¬</button>
        </div>
    </div>

    <script>
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbw_N70JbKzPfWtNHVVfxip9uYQTRF1DWxkpAHvb5nbh7uCosHA7bBV5RsY8FcjdjG-A/exec";

        document.getElementById('dateField').valueAsDate = new Date();

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function toggleLoader(show) {
            document.getElementById('loader').style.display = show ? 'flex' : 'none';
        }

        // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
        document.getElementById('orderForm').onsubmit = async (e) => {
            e.preventDefault();
            toggleLoader(true);
            const params = new URLSearchParams(new FormData(e.target));
            params.append("action", "addOrder");

            fetch(`${SCRIPT_URL}?${params.toString()}`)
                .then(r => r.json())
                .then(res => {
                    toggleLoader(false);
                    alert("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­");
                    e.target.reset();
                    showScreen('mainScreen');
                }).catch(() => {
                    toggleLoader(false);
                    alert("âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø¬ÙˆØ¬Ù„ Ø´ÙŠØª");
                    showScreen('mainScreen');
                });
        };

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        document.getElementById('loginForm').onsubmit = async (e) => {
            e.preventDefault();
            toggleLoader(true);
            const user = e.target.username.value;
            const pass = e.target.password.value;

            fetch(`${SCRIPT_URL}?action=login&username=${encodeURIComponent(user)}&password=${encodeURIComponent(pass)}`)
                .then(r => r.json())
                .then(data => {
                    toggleLoader(false);
                    if(data.status === "success") {
                        document.getElementById('welcomeMsg').innerText = "Ù…Ø±Ø­Ø¨Ø§Ù‹: " + data.user;
                        showScreen('summaryScreen');
                    } else {
                        alert("âŒ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­!");
                    }
                }).catch(() => {
                    toggleLoader(false);
                    alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„");
                });
        };
    </script>
</body>
</html>
